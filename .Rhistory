View(augmentedLeaderboard)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(janitor)
library(rvest)
page <- read_html("https://www.fangraphs.com/leaders.aspx?pos=all&stats=bat&lg=nl&qual=y&type=c,4,6,7,9,10,11,14,16,21,289,290,291,292,61,53,111,203,54,56,199,204,55,57,58&season=2022&month=0&season1=1871&ind=1&team=0&rost=&age=&filter=&players=&startdate=&enddate=&page=1_10000")
leaderboardNL <- page %>%
html_nodes("table") %>%
.[[7]] %>%
html_table()
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(1, 2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboard)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(
individualRPW = RAR/WAR,
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
View(augmentedLeaderboard)
View(augmentedLeaderboardNL)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(RPW = mean(individualRPW), WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
View(augmentedLeaderboardNL)
cleanLeaderboardNL %>%
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(1, 2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(cleanLeaderboardNL)] <- convertToDouble
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(1, 2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboard)
cleanLeaderboardNL %>%
mutate(NA = is.na(WAR))
cleanLeaderboardNL %>%
mutate(NAt = is.na(WAR))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
cleanLeaderboardNL %>%
mutate(NAt = is.na(WAR)) %>%
levels(NAt)
cleanLeaderboardNL %>%
mutate(NAt = is.na(WAR))
levels(cleanLeaderboardNL$NAt)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
mutate(NAt = is.na(WAR))
levels(check$NAt)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
mutate(NAt = is.na(WAR))
levels(factor(check$NAt))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
mutate(NAt = is.na(RAR))
levels(factor(check$NAt))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
mutate(NAt = is.na(RAR))
levels(factor(check$NAt))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(factor(Season)) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboard)
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboard)
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double) %>%
mutate(Season = as.double(Season))
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double) %>%
as.double(Season)
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double) %>%
mutate(Season = as.double(Season))
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
cleanLeaderboardNL <- cleanLeaderboardNL %>%
mutate(Season = as.double(Season))
head(cleanLeaderboard)
cleanLeaderboardNL <- leaderboard %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team)) %>%
mutate(Season = factor(Season))
convertToDouble <- sapply(cleanLeaderboard[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboard)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboardNL)
check <- cleanLeaderboardNL %>%
mutate(NAt = is.na(RAR))
levels(factor(check$NAt))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
filter(Season == 2008)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
View(check)
check <- cleanLeaderboardNL %>%
filter(Season == 2008) %>%
mutate(individualRPW = RAR/WAR) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
check <- cleanLeaderboardNL %>%
filter(Season == 2008) %>%
mutate(individualRPW = RAR/WAR) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
?ifelse
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
arrange(desc(WAA))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
levels(augmentedLeaderboardNL$WAA)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
levels(factor(augmentedLeaderboardNL$WAA))
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
show_candidates <- function(leaderboard, year) {
df %>%
filter(Season == year) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= max)
}
show_candidates <- function(leaderboard, year) {
df %>%
filter(Season == year) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= max)
}
head(show_candidates(augmentedLeaderboardNL, 2022))
show_candidates <- function(leaderboard, year) {
df %>%
filter(Season == year) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= max)
}
show_candidates(augmentedLeaderboardNL, 2022)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= max)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
select(-c(max)) %>%
filter(WAA >= max) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(max = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= max) %>%
select(-c(max)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(max = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= max) %>%
select(-c(max)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(max = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= max) %>%
#select(-c(max)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= max) %>%
select(-c(max)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(max)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(Season)
augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
View(candidates)
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.9, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.5, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
mutate(percentOff = Off/(RAR-Rep))
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.5, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
mutate(percentOff = (Off/(RAR-Rep))*100) %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.5, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.8, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1)) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.825, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.825, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(janitor)
library(rvest)
page <- read_html("https://www.fangraphs.com/leaders.aspx?pos=all&stats=bat&lg=nl&qual=y&type=c,4,6,7,9,10,11,14,16,21,289,290,291,292,61,53,111,203,54,56,199,204,55,57,58&season=2022&month=0&season1=1871&ind=1&team=0&rost=&age=&filter=&players=&startdate=&enddate=&page=1_10000")
leaderboardNL <- page %>%
html_nodes("table") %>%
.[[7]] %>%
html_table()
cleanLeaderboardNL <- leaderboardNL %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team)) %>%
mutate(Season = factor(Season))
convertToDouble <- sapply(cleanLeaderboardNL[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboardNL)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboardNL)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
cleanLeaderboardNL <- leaderboardNL %>%
filter(!row_number() %in% c(1, 3)) %>%
row_to_names(row_number = 1) %>%
select(-c(`#`, Team)) %>%
mutate(Season = as.double(Season))
convertToDouble <- sapply(cleanLeaderboardNL[ , -c(2)], as.double)
colnames <- colnames(cleanLeaderboardNL)
cleanLeaderboardNL[ , colnames %in% colnames(convertToDouble)] <- convertToDouble
head(cleanLeaderboardNL)
augmentedLeaderboardNL <- cleanLeaderboardNL %>%
filter(WAR > 0) %>%
mutate(individualRPW = RAR/WAR) %>%
group_by(Season) %>%
mutate(
RPW = mean(individualRPW),
WAA = round((RAR - Rep)/RPW, digits = 1)) %>%
select(-c(individualRPW, RPW)) %>%
filter(WAA > 0) %>%
arrange(desc(WAA))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
arrange(desc(Season))
candidates <- augmentedLeaderboardNL %>%
group_by(Season) %>%
mutate(threshold = round(max(WAA)*0.85, digits = 1) - 0.1) %>%
filter(WAA >= threshold) %>%
select(-c(threshold)) %>%
count(Name)
candidates %>%
count(Name)
candidates %>%
count(factor(Name))
candidates %>%
count(Name)
candidates %>%
group_by(Name) %>%
summarize(n())
candidates %>%
group_by(Name) %>%
summarize(n()) %>%
arrange(desc(n()))
candidates %>%
group_by(Name) %>%
summarize(n()) %>%
arrange(desc(n))
candidates %>%
group_by(Name) %>%
summarize(count = n()) %>%
arrange(desc(count))
