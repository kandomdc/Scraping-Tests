library(stringr)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
mutate(
C = str_replace(C, 'X', 'C'),
`1B` = str_replace(`1B`, 'X', '1B'),
`2B` = str_replace(`2B`, 'X', '2B'),
`3B` = str_replace(`3B`, 'X', '3B'),
SS = str_replace(SS, 'X', 'SS'),
OF = str_replace(OF, 'X', 'OF'),
DH = str_replace(DH, 'X', 'DH'))
View(clean_positions)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]]
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
str_replace_all('X', TRUE)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
str_replace_all('X', 'TRUE')
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]]
#tidyr::pivot_longer(cols = -c())
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True')
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X')
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
split(Names, ', ', c('last_name', 'first_name'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
split(Player, ', ', c('last_name', 'first_name'))
?split
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
split(f = Player sep = ', ', c('last_name', 'first_name'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
split(f = Player, sep = ', ', c('last_name', 'first_name'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
split(clean_positions$Player, sep = ', ', c('last_name', 'first_name'))
View(clean_positions)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
tidyr::pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name'))
library(dplyr)
library(rvest)
library(stringr)
library(tidyr)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name'))
View(clean_positions)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, minpos, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_positions %>% left_join(clean_hitter_data)
View(clean_hitter_data)
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
janitor::make_clean_names(PlayerName, case = 'title')
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title'))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title')) %>%
str_remove(PlayerName, " Jr")
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
)
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title')) %>%
str_remove(" Jr")
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title')) %>%
str_remove(" Jr")
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title')) %>%
str_remove(PlayerName, " Jr")
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title'))
#str_remove(PlayerName, " Jr")
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title'))
str_remove(PlayerName)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title'))
mutate(PlayerName = str_remove(PlayerName, " Jr"))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'title')) %>%
mutate(PlayerName = str_remove(PlayerName, " Jr"))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName'))
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'none')) %>%
mutate(PlayerName = str_remove(PlayerName, " Jr"))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'none')) %>%
mutate(PlayerName = str_replace_all(str_remove(PlayerName, '_Jr'), '_', ' '))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'none')) %>%
mutate(PlayerName = str_replace_all(str_remove(PlayerName, '_Jr'), '_', ' '))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName'))
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName')) %>%
filter(is.na(Team))
compute_batter_points <- function(R, TB, RBI, BB, K, SB) {
R + TB + RBI + BB - K + SB
}
compute_pitcher_points <- function(IP, H, ER, BB, K, W, L, SV, HD) {
3*IP - H - 2*ER - BB + K + 2*W - 2*L + 5*SV + 2*HD
}
clean_hitter_data %>%
mutate(
`1B` = H - `2B` -`3B` - HR,
TB = `1B` + 2*`2B` + 3*`3B` + 4*HR,
Points = compute_batter_points(R, TB, RBI, BB, SO, SB)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
clean_pitcher_data %>%
mutate(Points = compute_pitcher_points(IP, H, ER, BB, SO, W, L, SV, HLD)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(rvest)
library(stringr)
library(tidyr)
hitter_dat <- read_html("https://www.fangraphs.com/projections?pos=all&stats=bat&type=rfangraphsdc&statgroup=fantasy") %>% html_elements('#__NEXT_DATA__') %>% html_text() %>% jsonlite::fromJSON()
hitter_data <- hitter_dat$props$pageProps$dehydratedState$queries$state$data[[1]]
positions <- read_html('https://www.tgfantasybaseball.com/baseball/pos_elig.cfm')
pitcher_dat <- read_html("https://www.fangraphs.com/projections?pos=&stats=pit&type=rfangraphsdc&statgroup=fantasy") %>% html_elements('#__NEXT_DATA__') %>% html_text() %>% jsonlite::fromJSON()
pitcher_data <- pitcher_dat$props$pageProps$dehydratedState$queries$state$data[[1]]
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'none')) %>%
mutate(PlayerName = str_replace_all(str_remove(PlayerName, '_Jr'), '_', ' '))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_hitter_data %>% left_join(clean_positions, by = c('PlayerName' = 'Name')) %>%
filter(is.na(Team))
compute_batter_points <- function(R, TB, RBI, BB, K, SB) {
R + TB + RBI + BB - K + SB
}
compute_pitcher_points <- function(IP, H, ER, BB, K, W, L, SV, HD) {
3*IP - H - 2*ER - BB + K + 2*W - 2*L + 5*SV + 2*HD
}
clean_hitter_data %>%
mutate(
`1B` = H - `2B` -`3B` - HR,
TB = `1B` + 2*`2B` + 3*`3B` + 4*HR,
Points = compute_batter_points(R, TB, RBI, BB, SO, SB)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
clean_pitcher_data %>%
mutate(Points = compute_pitcher_points(IP, H, ER, BB, SO, W, L, SV, HLD)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
clean_hitter_data %>% left_join(clean_positions, by = c('PlayerName' = 'Name'))
clean_hitter_data %>% left_join(clean_positions, by = c('PlayerName' = 'Name')) filter(is.na(Pos))
clean_hitter_data %>% left_join(clean_positions, by = c('PlayerName' = 'Name')) %>%
filter(is.na(Pos))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(rvest)
library(stringr)
library(tidyr)
hitter_dat <- read_html("https://www.fangraphs.com/projections?pos=all&stats=bat&type=rfangraphsdc&statgroup=fantasy") %>% html_elements('#__NEXT_DATA__') %>% html_text() %>% jsonlite::fromJSON()
hitter_data <- hitter_dat$props$pageProps$dehydratedState$queries$state$data[[1]]
positions <- read_html('https://www.tgfantasybaseball.com/baseball/pos_elig.cfm')
pitcher_dat <- read_html("https://www.fangraphs.com/projections?pos=&stats=pit&type=rfangraphsdc&statgroup=fantasy") %>% html_elements('#__NEXT_DATA__') %>% html_text() %>% jsonlite::fromJSON()
pitcher_data <- pitcher_dat$props$pageProps$dehydratedState$queries$state$data[[1]]
clean_hitter_data <- hitter_data %>%
select(
PlayerName, Team, H, `2B`, `3B`, HR, R, RBI, BB, SO, SB
) %>%
mutate(PlayerName = janitor::make_clean_names(PlayerName, case = 'none')) %>%
mutate(PlayerName = str_replace_all(str_remove(PlayerName, '_Jr'), '_', ' '))
clean_pitcher_data <- pitcher_data %>%
select(
PlayerName, Team, IP, H, ER, BB, SO, W, L, SV, HLD
)
clean_positions <- positions %>%
html_table(header = T) %>%
.[[1]] %>%
pivot_longer(cols = -c('Player'), names_to = 'Pos', values_to = 'True') %>%
filter(True == 'X') %>%
separate(Player, sep = ', ', c('last_name', 'first_name')) %>%
mutate(Name = paste(first_name, last_name)) %>%
select(Name, Pos)
clean_positions %>% left_join(clean_hitter_data, by = c('Name' = 'PlayerName')) %>%
filter(is.na(Team))
compute_batter_points <- function(R, TB, RBI, BB, K, SB) {
R + TB + RBI + BB - K + SB
}
compute_pitcher_points <- function(IP, H, ER, BB, K, W, L, SV, HD) {
3*IP - H - 2*ER - BB + K + 2*W - 2*L + 5*SV + 2*HD
}
clean_hitter_data %>%
mutate(
`1B` = H - `2B` -`3B` - HR,
TB = `1B` + 2*`2B` + 3*`3B` + 4*HR,
Points = compute_batter_points(R, TB, RBI, BB, SO, SB)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
clean_pitcher_data %>%
mutate(Points = compute_pitcher_points(IP, H, ER, BB, SO, W, L, SV, HLD)) %>%
select(PlayerName, Team, Points) %>%
arrange(desc(Points))
